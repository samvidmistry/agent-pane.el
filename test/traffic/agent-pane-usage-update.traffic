(
 ((:direction . outgoing)
  (:kind . request)
  (:object . ((jsonrpc . "2.0")
             (method . "initialize")
             (id . 1)
             (params . ((protocolVersion . 1)
                        (clientCapabilities . ((fs . ((readTextFile . :false)
                                                     (writeTextFile . :false))))))))))
 ((:direction . incoming)
  (:kind . response)
  (:object . ((jsonrpc . "2.0")
             (id . 1)
             (result . ((protocolVersion . 1)
                        (agentCapabilities . ((promptCapabilities . ((embeddedContext . :false)
                                                                    (image . :false))))))))))

 ((:direction . outgoing)
  (:kind . request)
  (:object . ((jsonrpc . "2.0")
             (method . "authenticate")
             (id . 2)
             (params . ((methodId . "chatgpt"))))))
 ((:direction . incoming)
  (:kind . response)
  (:object . ((jsonrpc . "2.0")
             (id . 2)
             (result . ((ok . t))))))

 ((:direction . outgoing)
  (:kind . request)
  (:object . ((jsonrpc . "2.0")
             (method . "session/new")
             (id . 3)
             (params . ((cwd . "/tmp")
                        (mcpServers . []))))))
 ((:direction . incoming)
  (:kind . response)
  (:object . ((jsonrpc . "2.0")
             (id . 3)
             (result . ((sessionId . "fake-session-usage"))))))

 ((:direction . outgoing)
  (:kind . request)
  (:object . ((jsonrpc . "2.0")
             (method . "session/set_mode")
             (id . 4)
             (params . ((sessionId . "fake-session-usage")
                        (modeId . "bypassPermissions"))))))
 ((:direction . incoming)
  (:kind . response)
  (:object . ((jsonrpc . "2.0")
             (id . 4)
             (result . ((ok . t))))))

 ((:direction . outgoing)
  (:kind . request)
  (:object . ((jsonrpc . "2.0")
             (method . "session/prompt")
             (id . 5)
             (params . ((sessionId . "fake-session-usage")
                        (prompt . [((type . "text") (text . "hi"))]))))))

 ;; Streaming agent output.
 ((:direction . incoming)
  (:kind . notification)
  (:object . ((jsonrpc . "2.0")
             (method . "session/update")
             (params . ((sessionId . "fake-session-usage")
                        (update . ((sessionUpdate . "agent_message_chunk")
                                   (content . ((text . "Hello, world."))))))))))

 ;; Usage update notification (ACP RFD format).
 ((:direction . incoming)
  (:kind . notification)
  (:object . ((jsonrpc . "2.0")
             (method . "session/update")
             (params . ((sessionId . "fake-session-usage")
                        (update . ((sessionUpdate . "usage_update")
                                   (used . 31400)
                                   (size . 200000)
                                   (cost . ((amount . 0.045)
                                            (currency . "USD"))))))))))

 ;; Prompt response with per-turn usage.
 ((:direction . incoming)
  (:kind . response)
  (:object . ((jsonrpc . "2.0")
             (id . 5)
             (result . ((stopReason . "end_turn")
                        (usage . ((total_tokens . 53000)
                                  (input_tokens . 35000)
                                  (output_tokens . 12000)))))))))
)
