(
 ((:direction . outgoing)
  (:kind . request)
  (:object . ((jsonrpc . "2.0")
             (method . "initialize")
             (id . 1)
             (params . ((protocolVersion . 1)
                        (clientCapabilities . ((fs . ((readTextFile . :false)
                                                     (writeTextFile . :false))))))))))
 ((:direction . incoming)
  (:kind . response)
  (:object . ((jsonrpc . "2.0")
             (id . 1)
             (result . ((protocolVersion . 1)
                        (agentCapabilities . ((promptCapabilities . ((embeddedContext . :false)
                                                                    (image . :false))))))))))

 ((:direction . outgoing)
  (:kind . request)
  (:object . ((jsonrpc . "2.0")
             (method . "authenticate")
             (id . 2)
             (params . ((methodId . "chatgpt"))))))
 ((:direction . incoming)
  (:kind . response)
  (:object . ((jsonrpc . "2.0")
             (id . 2)
             (result . ((ok . t))))))

 ((:direction . outgoing)
  (:kind . request)
  (:object . ((jsonrpc . "2.0")
             (method . "session/new")
             (id . 3)
             (params . ((cwd . "/tmp")
                        (mcpServers . []))))))
 ((:direction . incoming)
  (:kind . response)
  (:object . ((jsonrpc . "2.0")
             (id . 3)
             (result . ((sessionId . "fake-session-1"))))))

 ((:direction . outgoing)
  (:kind . request)
  (:object . ((jsonrpc . "2.0")
             (method . "session/set_mode")
             (id . 4)
             (params . ((sessionId . "fake-session-1")
                        (modeId . "bypassPermissions"))))))
 ((:direction . incoming)
  (:kind . response)
  (:object . ((jsonrpc . "2.0")
             (id . 4)
             (result . ((ok . t))))))

 ((:direction . outgoing)
  (:kind . request)
  (:object . ((jsonrpc . "2.0")
             (method . "session/prompt")
             (id . 5)
             (params . ((sessionId . "fake-session-1")
                        (prompt . [((type . "text") (text . "hi"))]))))))

 ;; Interleaved streaming updates.
 ((:direction . incoming)
  (:kind . notification)
  (:object . ((jsonrpc . "2.0")
             (method . "session/update")
             (params . ((sessionId . "fake-session-1")
                        (update . ((sessionUpdate . "agent_thought_chunk")
                                   (content . ((type . "text")
                                               (text . "Thinking..."))))))))))

 ((:direction . incoming)
  (:kind . notification)
  (:object . ((jsonrpc . "2.0")
             (method . "session/update")
             (params . ((sessionId . "fake-session-1")
                        (update . ((sessionUpdate . "agent_message_chunk")
                                   (content . ((type . "text")
                                               (text . "Hello"))))))))))

 ((:direction . incoming)
  (:kind . notification)
  (:object . ((jsonrpc . "2.0")
             (method . "session/update")
             (params . ((sessionId . "fake-session-1")
                        (update . ((sessionUpdate . "tool_call")
                                   (toolCallId . "tc1")
                                   (status . "in_progress")
                                   (title . "bash")
                                   (kind . "tool")
                                   (rawInput . ((command . "echo hi")
                                               (description . "demo")))
                                   (content . [])
                                   (locations . []))))))))

 ((:direction . incoming)
  (:kind . notification)
  (:object . ((jsonrpc . "2.0")
             (method . "session/update")
             (params . ((sessionId . "fake-session-1")
                        (update . ((sessionUpdate . "agent_message_chunk")
                                   (content . ((type . "text")
                                               (text . " after tool"))))))))))

 ((:direction . incoming)
  (:kind . notification)
  (:object . ((jsonrpc . "2.0")
             (method . "session/update")
             (params . ((sessionId . "fake-session-1")
                        (update . ((sessionUpdate . "tool_call_update")
                                   (toolCallId . "tc1")
                                   (status . "completed")
                                   (rawInput . ((command . "echo hi")))
                                   (content . [((type . "content")
                                               (content . ((type . "text")
                                                           (text . "ok"))))]))))))))

 ((:direction . incoming)
  (:kind . notification)
  (:object . ((jsonrpc . "2.0")
             (method . "session/update")
             (params . ((sessionId . "fake-session-1")
                        (update . ((sessionUpdate . "agent_message_chunk")
                                   (content . ((type . "text")
                                               (text . "Done."))))))))))

 ((:direction . incoming)
  (:kind . response)
  (:object . ((jsonrpc . "2.0")
             (id . 5)
             (result . ((stopReason . "end_turn"))))))
)
